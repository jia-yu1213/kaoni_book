<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MyList-Mapper">
	
	<sql id="search">
		<if test="searchType == 't'.toString()">
			and title like '%'||#{keyword}||'%'			
		</if>
		<if test="searchType == 'w'.toString()">
			and writer like '%'||#{keyword}||'%'			
		</if>

	</sql>
	<select id="selectRentListByID" resultType="rent" parameterType="str">
	/* selectRentListByID 아이디로 대여이력 가져오기*/
	    select 
	    	rownum, a.* 
        from(
    	    select a.*(select book_title, writer from book where book_no =  a.book_no) 
        	from book_rent a where id = #{id}
			<include refid="search" />
			order by a.rent_no desc
        ) A
	</select>
	
	<select id="selectRentListByIDCount" resultType="int" parameterType="str">
	/* selectRentListByMemIDCount 아이디로 대여이력 갯수 가져오기*/
		select a.*(select book_title, writer from book where book_no =  a.book_no) 
      	from book_rent a where mem_id = #{mem_id}
		<include refid="search" />
		order by a.rent_no desc
	</select>
	
	
</mapper>








